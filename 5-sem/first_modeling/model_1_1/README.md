# Исследование: Связанные состояния в потенциальной яме произвольной формы

## Постановка задачи

Требуется на основе стационарного уравнения Шрёдингера:

1. Определить **связанные состояния** и соответствующие им **уровни энергии** для частицы в потенциальной яме **произвольной формы**
2. Визуализировать полученные **волновые функции** и **плотности вероятности**
3. Проанализировать **волновые числа** и **глубины проникновения** для каждого состояния
4. Исследовать влияние формы потенциала на квантовые характеристики системы

---

**Цель исследования:** Разработать универсальный численный метод для анализа квантовых систем с потенциалами произвольной формы и исследовать их спектральные свойства.

---

## Физическая модель

### Универсальное задание потенциала

Потенциальная энергия может быть задана **шестью различными способами**:

1. **Прямоугольная яма**
2. **Параболическая яма**  
3. **Треугольная яма**
4. **Двойная яма**
5. **Произвольная аналитическая функция**
6. **Таблично заданный потенциал**

**Базовые параметры:**
- $a = 1$ нм — ширина расчетной области
- $U$ — глубина потенциальной ямы (задается для каждого типа)
- Область определения: $x \in [0, a]$

---

## Методика решения

### Уравнение Шрёдингера и численный метод

Решается одномерное стационарное уравнение Шрёдингера:

```math
\hat{H}\psi(x) = E\psi(x)
```

где гамильтониан системы:
```math
\hat{H} = -\frac{\hbar^2}{2m}\frac{d^2}{dx^2} + U(x)
```

**Физические константы:**
- $\hbar = 1.0545718 \times 10^{-34}$ Дж·с — редуцированная постоянная Планка
- $m = 9.1093837 \times 10^{-31}$ кг — масса электрона
- Коэффициент перевода: $1$ эВ $= 1.6021766 \times 10^{-19}$ Дж

### Универсальный алгоритм решения

#### 1. Задание потенциала
```python
# Произвольная аналитическая функция
solver.set_potential('arbitrary', function=my_potential)

# Стандартные формы
solver.set_potential('rectangular', U_eV=10.0, left_bound=0.2, right_bound=0.8)
solver.set_potential('parabolic', U_eV=15.0, width=0.6e-9)
solver.set_potential('triangular', U_eV=12.0, left=0.3, right=0.7)
solver.set_potential('double_well', U_eV=8.0, well_width=0.15e-9, barrier_width=0.1e-9)

# Табличные данные
solver.set_potential('table', x_table=x_data, U_table=U_data)
```

#### 2. Дискретизация и построение матрицы

- **Пространственная сетка:** $N = 1000$ точек, $\Delta x = \frac{a}{N-1}$
- **Аппроксимация оператора Лапласа:**
  ```math
  \frac{d^2\psi}{dx^2} \approx \frac{\psi_{i+1} - 2\psi_i + \psi_{i-1}}{\Delta x^2}
  ```

- **Матрица Гамильтониана:**
  - Коэффициент кинетической энергии: $k_{\text{coeff}} = \frac{\hbar^2}{2m\Delta x^2}$
  - Главная диагональ: $H_{ii} = 2k_{\text{coeff}} + U(x_i)$
  - Внедиагональные элементы: $H_{i,i+1} = H_{i,i-1} = -k_{\text{coeff}}$

#### 3. Решение спектральной задачи
```math
H\psi_n = E_n\psi_n
```

#### 4. Нормировка волновых функций
```math
\int_0^a |\psi(x)|^2 dx = 1
```

### Анализ связанных состояний

**Критерий связанных состояний:** $E < 0$

**Волновые числа для произвольного потенциала:**
- В областях притяжения:
  ```math
  k = \frac{\sqrt{2m(E - U_{\text{min}})}}{\hbar}
  ```
- В классически запрещенных областях:
  ```math
  \kappa = \frac{\sqrt{2m(U - E)}}{\hbar}
  ```

**Физические характеристики:**
- Длина волны де Бройля: $\lambda = \frac{2\pi}{k}$
- Глубина проникновения: $d = \frac{1}{\kappa}$
- Количество узлов: $n-1$ для $n$-го возбужденного состояния

---

## Визуализация результатов

### Основные графики:

1. **Потенциал с волновыми функциями** — наложение нормированных волновых функций на профиль потенциала
2. **Плотности вероятности** — распределение $|\psi_n(x)|^2$ по координате
3. **Детальный анализ** — дополнительные графики для углубленного изучения

### Информационные блоки:
- **Волновые числа** и физические параметры каждого состояния
- **Энергетические уровни** с точностью до 0.001 эВ
- **Статистика узлов** и симметрии волновых функций

### Масштабирование визуализации:
- Автоматическое определение масштаба относительно глубины ямы
- Волновые функции: $\text{scale} = 0.15 \times |U_{\text{min}}|$
- Плотности вероятности: $\text{scale} = 0.2 \times |U_{\text{min}}|$

---

## Особенности реализации

### Гибкая архитектура:
- **Универсальный класс** `QuantumWellSolver` для всех типов потенциалов
- **Модульная система** добавления новых форм потенциалов
- **Автоматическая интерполяция** таблично заданных данных

### Численная устойчивость:
- **Точное решение** методом собственных значений
- **Оптимизированные алгоритмы** для трехдиагональных матриц
- **Адаптивное нормирование** волновых функций

### Физический анализ:
- **Автоматическое вычисление** волновых чисел и глубины проникновения
- **Статистика узлов** волновых функций
- **Проверка ортогональности** различных состояний

### Профессиональная визуализация:
- **Цветовое кодирование** различных энергетических состояний
- **Интерактивные легенды** с физическими параметрами
- **Многоуровневая система** графиков для комплексного анализа

---

## Ожидаемые результаты

### Для каждого типа потенциала:
- **Энергетические спектры** связанных состояний
- **Волновые функции** и их узловая структура
- **Плотности вероятности** распределения частицы
- **Волновые числа** и параметры затухания

### Сравнительный анализ:
- Влияние **формы потенциала** на энергетический спектр
- Зависимость **глубины проникновения** от энергии состояния
- Особенности **симметрии** волновых функций для различных потенциалов

### Физические закономерности:
- **Квантование энергии** в потенциалах различной формы
- Соответствие **теории возмущений** для слабо-негармонических систем
- **Туннельные эффекты** в двойных и сложных потенциалах

---

## Практическая значимость

Разработанный инструмент позволяет:

1. **Исследовать** квантовые системы с потенциалами произвольной формы
2. **Верифицировать** аналитические решения для стандартных потенциалов
3. **Проектировать** квантовые ямы для наноэлектронных устройств
4. **Обучать** основам квантовой механики с наглядной визуализацией
