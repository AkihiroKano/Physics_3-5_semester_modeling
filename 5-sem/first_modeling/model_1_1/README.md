# Связанные состояния в потенциальной яме произвольной формы

## Постановка задачи

Рассматривается движение квантовой частицы (электрона) в **одномерной потенциальной яме произвольной формы**, задаваемой аналитической функцией или таблично:

$$
U(x) = f(x), \quad x \in [0, a]
$$

где:

- $U(x)$ — потенциальная энергия как функция координаты
- $a$ — ширина расчетной области
- $f(x)$ — произвольная функция, описывающая форму потенциальной ямы
- Область определения: $x \in [0, a]$

Требуется на основе стационарного уравнения Шрёдингера:

1. Определить **связанные состояния** и соответствующие им **уровни энергии** для частицы в потенциальной яме **произвольной формы**
2. Визуализировать полученные **волновые функции** и **плотности вероятности**
3. Проанализировать **волновые числа** и **глубины проникновения** для каждого состояния
4. Исследовать влияние формы потенциала на квантовые характеристики системы

---

**Цель исследования:** Разработать универсальный численный метод для анализа квантовых систем с потенциалами произвольной формы и исследовать их спектральные свойства.

---

## Физическая модель и математический аппарат

### Стационарное уравнение Шрёдингера

Решается одномерное стационарное уравнение Шрёдингера:

$$
\hat{H}\psi(x) = E\psi(x)
$$

где гамильтониан системы:

$$
\hat{H} = -\frac{\hbar^2}{2m}\frac{d^2}{dx^2} + U(x)
$$

**Физические константы:**

- $\hbar = 1.0545718 \times 10^{-34}$ Дж·с — редуцированная постоянная Планка
- $m = 9.1093837 \times 10^{-31}$ кг — масса электрона
- Коэффициент перевода: $1$ эВ $= 1.6021766 \times 10^{-19}$ Дж

---

## Методика решения

### Универсальный алгоритм решения

#### 1. Задание потенциала

```python
# Произвольная аналитическая функция
solver.set_potential('arbitrary', function=my_potential)

# Стандартные формы
solver.set_potential('rectangular', U_eV=10.0, left_bound=0.2, right_bound=0.8)
solver.set_potential('parabolic', U_eV=15.0, width=0.6e-9)
solver.set_potential('triangular', U_eV=12.0, left=0.3, right=0.7)
solver.set_potential('double_well', U_eV=8.0, well_width=0.15e-9, barrier_width=0.1e-9)

# Табличные данные
solver.set_potential('table', x_table=x_data, U_table=U_data)
```

**Примечание о единицах измерения:**

- Параметры `left_bound`, `right_bound`, `left`, `right` задаются в **долях от ширины области a**
- Параметры `width`, `well_width`, `barrier_width` задаются в **метрах (м)**

#### 2. Дискретизация и построение матрицы

**Дискретизация пространства:**

- Область $[0, a]$ разбивается на $N = 1000$ равномерных точек
- Шаг сетки: $\Delta x = \frac{a}{N-1}$
- Узлы сетки: $x_i = i \cdot \Delta x$, где $i = 0, 1, ..., N-1$

**Аппроксимация оператора Лапласа:**
Вторая производная аппроксимируется центральными разностями второго порядка точности:

$$
\frac{d^2\psi}{dx^2} \approx \frac{\psi_{i+1} - 2\psi_i + \psi_{i-1}}{\Delta x^2}
$$

**Построение матрицы Гамильтониана:**
Матрица Гамильтониана имеет трехдиагональный вид:

- Коэффициент кинетической энергии: $k_{\text{coeff}} = \frac{\hbar^2}{2m\Delta x^2}$
- Главная диагональ: $H_{ii} = 2k_{\text{coeff}} + U(x_i)$
- Внедиагональные элементы: $H_{i,i+1} = H_{i,i-1} = -k_{\text{coeff}}$

#### 3. Решение спектральной задачи

Уравнение Шрёдингера в матричной форме:

$$
H\psi_n = E_n\psi_n
$$

где:

- $H$ — матрица Гамильтониана ($N \times N$)
- $E_n$ — собственные значения (энергетические уровни)
- $\psi_n$ — собственные векторы (волновые функции в дискретных точках)

#### 4. Нормировка волновых функций

Волновые функции нормируются условием:

$$
\int_0^a |\psi(x)|^2 dx = 1
$$

В дискретном виде:

$$
\sum_{i=0}^{N-1} |\psi_i|^2 \Delta x \approx 1
$$

---

### Анализ связанных состояний

**Критерий связанных состояний:** $E < 0$

**Волновые числа:**

- В областях притяжения (внутри ямы):
  $$
  k = \frac{\sqrt{2m(E - U_{\text{min}})}}{\hbar}
  $$
  где $U_{\text{min}}$ — минимальное значение потенциала в яме.

- В классически запрещенных областях (вне ямы):
  $$
  \kappa = \frac{\sqrt{-2mE}}{\hbar}
  $$
  В данной работе используется упрощение, предполагающее, что вне ямы потенциал $U(x) = 0$. Для связанных состояний ($E < 0$) выражение под корнем положительно.

**Физические характеристики:**

- **Длина волны де Бройля:** $\lambda = \frac{2\pi}{k}$
- **Глубина проникновения:** $d = \frac{1}{\kappa}$
- **Количество узлов:** $n-1$ для $n$-го возбужденного состояния

**Физическая интерпретация:**

- $k$ определяет осцилляционное поведение волновой функции в областях притяжения
- $\kappa$ определяет экспоненциальное затухание в областях отталкивания
- **Узлы волновой функции** — точки, где $\psi(x) = 0$, соответствуют нулевой вероятности обнаружения частицы

---

## Физическая интерпретация результатов

### Квантование энергии

В потенциальной яме энергия принимает **дискретные значения**:
$$
E_1 < E_2 < E_3 < \dots
$$

**Основное состояние** ($n=1$):

- Наименьшая энергия
- Не имеет узлов (кроме граничных)
- Наибольшая вероятность нахождения в центре ямы

**Возбужденные состояния** ($n>1$):

- Имеют $n-1$ узлов
- Чем выше энергия, тем больше узлов

### Распределение вероятности

**Плотность вероятности** $|\psi_n(x)|^2$ показывает, где вероятнее всего обнаружить частицу:

- В связанных состояниях максимальна внутри ямы
- Экспоненциально убывает за пределами ямы
- Число максимумов равно номеру состояния $n$

### Туннельные эффекты

В двойных и сложных потенциалах наблюдается **туннелирование** — ненулевая вероятность найти частицу в классически запрещенной области (например, под барьером).
